# 스레드와 프로세스

## 프로세스 
- 프로그램이 메모리에 적재되어 실행되고 있을 때 프로세스라고 함. 프로그램의 복사본
- 운영체제로부터 메모리, CPU 시간 등의 자원을 할당받아 독립적으로 실행됨

### 프로세스 메모리 공간
스택 (stack) - 아래로 데이터가 증가하며 일시적으로 사용하는 데이터가 존재. ex. 지역변수, 함수

힙 (heap) - 위로 데이터가 증가하며 프로그래머가 런타임에 동적으로 할당하는 데이터가 존재. ex. 객체, new 로 선언한 모든 것. GC(Garbage Collection)가 관리

데이터 (data) - static 하거나 전역 변수들이 존재

코드 (code) - 컴파일 된 명령어들이 존재. Read-Only

로 구성

## 스레드
- 프로세스 내 독립적인 실행 단위
- 스택영역과 레지스터만 스레드별로 새로 생성되며 다른 공간은 공유
- 각 스레드는 고유한 프로그램 카운터(PC)와 레지스터를 가지고 있으며, 현재 실행 중인 명령어와 관련된 데이터를 저장
  
## 멀티 스레드와 멀티 프로세스
- 멀티 프로세스
  - 서로 독립된 공간을 가지기에 데이터 무결성이 깨질리가 없다.
  - but. IPC라는 운영체제 자원을 통해서 통신해야 하기에 느리고 중복 코드가 많아진다.
- 멀티 스레드
  - 스택, 레지스터 영역을 제외하고는 프로세스 자원을 공유하기에 IPC보다 데이터 공유 속도가 빠르다.
  - but. 멀티스레드 환경에서 여러 스레드가 동시에 공유 자원에 접근할 때, 올바른 실행 순서를 보장하지 않으면 데이터 불일치가 발생할 수 있음

# 동기화 (Synchronization)
- 실행 순서 제어를 위한 동기화 
  - ex. write하고 read해야 하는 경우 write가 점유하기 전까지 read가 점유 못하도록 할 수 있음
- 상호 배제를 위한 동기화
  - 동시에 공유 자원에 접근하는 것을 막음
가 있음

## Race Condition
- 서로 다른 스레드가 같은 자원에 접근하여서 데이터 무결성이 깨지는 현상

## 임계영역 (Critical Section)
- 공유 자원에 접근하는 코드 블록으로 Race Condition이 발생할 수 있음.
- 동기화를 해줘야 한다.

## Mutex
- 하나의 스레드가 공유 자원에 접근 중일 때 다른 스레드가 접근하지 못하도록 하는 자물쇠
- 두 개의 상태(Locked, Unlocked)가 존재

## Semaphore
- 공유 자원이 여러개일 경우 사용하는 동기화 방식
- 이진 세마포어 (Binary Semaphore) -> Mutex처럼 동작하며, 한 번에 하나의 스레드만 자원에 접근 가능.
- 카운팅 세마포어 (Counting Semaphore) -> 여러 개의 스레드가 동시에 자원에 접근 가능하며, 남은 자원의 수를 카운트함.

## Monitor
- 공유 자원과 해당 자원에 대한 접근을 하나의 추상화된 객체로 묶어 관리하여 자원의 일관성을 자동으로 보장
- ex. Java의 synchronized 키워드
- 조건 변수(Condition Variable)를 통해서 실행 순서 제어도 가능
